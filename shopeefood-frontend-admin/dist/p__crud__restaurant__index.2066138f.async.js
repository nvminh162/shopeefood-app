"use strict";(self.webpackChunkhoidanit_admin_antd=self.webpackChunkhoidanit_admin_antd||[]).push([[573],{52311:function(De,ne,a){a.r(ne),a.d(ne,{default:function(){return Oe}});var oe=a(15009),g=a.n(oe),de=a(99289),P=a.n(de),ce=a(5574),f=a.n(ce),ve=a(26466),me=a(41756),he=a(29945),B=a(2453),z=a(66309),fe=a(86738),ge=a(28459),pe=a(14726),xe=a(85265),m=a(67294),C=a(32188),Se=a(18253),Ae=a(12119),je=a(46117),Ee=a(31484),Te=a(97857),re=a.n(Te),Re=a(37476),L=a(5966),Ce=a(53271),ye=a(52688),Ze=a(71230),y=a(15746),Ie=a(17788),w=a(2618),se=a(57632),e=a(85893),Pe=function(p){var c=p.reload,U=p.type,M=p.open,G=p.setOpen,l=p.currentRow,V=p.setCurrentRow,Y=B.ZP.useMessage(),o=f()(Y,2),j=o[0],ee=o[1],H=(0,m.useState)([]),k=f()(H,2),Z=k[0],O=k[1],J=(0,m.useState)(!1),K=f()(J,2),te=K[0],$=K[1],W=(0,m.useState)(""),I=f()(W,2),ae=I[0],X=I[1],Q=(0,m.useState)(""),b=f()(Q,2),q=b[0],D=b[1],T=(0,m.useRef)();(0,m.useEffect)(function(){if(l&&M&&U==="UPDATE"){var u,r;T==null||(u=T.current)===null||u===void 0||u.setFieldsValue(re()(re()({},l),{},{fileList:[{uid:(0,se.Z)(),name:(r=l==null?void 0:l.image)!==null&&r!==void 0?r:"",status:"done",url:"".concat("http://localhost:8080","/images/restaurant/").concat(l==null?void 0:l.image)}]})),O([{name:l.image,uid:(0,se.Z)()}])}},[l]);var _=(0,C.useRequest)(w.r4,{manual:!0,onSuccess:function(){j.success("Added successfully"),c==null||c()},onError:function(r){console.log(">>> check e: ",r)}}),ue=_.run,le=_.loading,d=function(r){var n=r.type==="image/jpeg"||r.type==="image/png"||r.type==="image/webp";n||B.ZP.error("You can only upload JPG/PNG/webp file!");var i=r.size/1024/1024<2;return i||B.ZP.error("Image must smaller than 2MB!"),n&&i},s=function(){var u=P()(g()().mark(function r(n){var i,h,F,v;return g()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return i=n.file,h=n.onSuccess,F=n.onError,N.next=3,(0,w.cT)(i,"restaurant");case 3:v=N.sent,v&&v.data?(O([{name:v.data.fileName,uid:i.uid}]),h("ok")):F("\u0110\xE3 c\xF3 l\u1ED7i khi upload file");case 5:case"end":return N.stop()}},r)}));return function(n){return u.apply(this,arguments)}}(),t=function(r,n){var i=new FileReader;i.addEventListener("load",function(){return n(i.result)}),i.readAsDataURL(r)},E=function(){var u=P()(g()().mark(function r(n){return g()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(n.url&&!n.originFileObj)){h.next=5;break}return X(n.url),$(!0),D(n.name||n.url.substring(n.url.lastIndexOf("/")+1)),h.abrupt("return");case 5:t(n.originFileObj,function(F){X(F),$(!0),D(n.name||n.url.substring(n.url.lastIndexOf("/")+1))});case 6:case"end":return h.stop()}},r)}));return function(n){return u.apply(this,arguments)}}(),R=function(){var r;O([]),V&&V(void 0),G&&G(!1),(r=T.current)===null||r===void 0||r.resetFields()},S=(0,C.useRequest)(w.mu,{manual:!0,onSuccess:function(){j.success("Create a new restaurant is successful"),c==null||c(),R()},onError:function(r){console.log(">>> check e: ",r)}}),x=S.run,A=(0,C.useRequest)(w.i1,{manual:!0,onSuccess:function(){j.success("Update the restaurant is successful"),c==null||c(),R()},onError:function(r){console.log(">>> check e: ",r)}}),ie=A.run;return(0,e.jsxs)(e.Fragment,{children:[ee,(0,e.jsx)(Re.Y,{open:M,title:"".concat(U==="CREATE"?"Add a new restaurant":"Update a restaurant"),modalProps:{maskClosable:!1,onCancel:R},onFinish:function(){var u=P()(g()().mark(function r(n){var i,h;return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(U!=="CREATE"){v.next=5;break}return v.next=3,x({name:n.name,phone:n.phone,email:n.email,address:n.address,isActive:n.isActive?n.isActive:!1,image:(i=Z[0])===null||i===void 0?void 0:i.name});case 3:v.next=7;break;case 5:return v.next=7,ie({_id:l==null?void 0:l._id,name:n.name,phone:n.phone,email:n.email,address:n.address,isActive:n.isActive,image:(h=Z[0])===null||h===void 0?void 0:h.name});case 7:return v.abrupt("return",!0);case 8:case"end":return v.stop()}},r)}));return function(r){return u.apply(this,arguments)}}(),formRef:T,children:(0,e.jsxs)(Ze.Z,{gutter:[30,0],children:[(0,e.jsx)(y.Z,{span:12,children:(0,e.jsx)(L.Z,{label:"Name",rules:[{required:!0,message:"Name kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"}],name:"name"})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsx)(L.Z,{label:"Phone",rules:[{required:!0,message:"Phone kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"}],name:"phone"})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsx)(L.Z,{label:"Address",name:"address",rules:[{required:!0,message:"address kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"}]})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsx)(L.Z,{label:"Email",rules:[{required:!0,message:"Email kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"},{type:"email",message:"Email kh\xF4ng \u0111\xFAng \u0111\u1ECBnh d\u1EA1ng"}],name:"email"})}),(0,e.jsx)(y.Z,{span:12,children:(0,e.jsx)(Ce.Z,{extra:"H\u1ED7 tr\u1EE3: .jpg, .jpeg, .png, .webp",label:"Image",name:"fileList",title:"upload",required:!0,fieldProps:{maxCount:1,multiple:!1,customRequest:s,beforeUpload:d,onPreview:E}})}),(0,e.jsx)(y.Z,{span:6,children:(0,e.jsx)(ye.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",name:"isActive",label:"Status"})})]})}),(0,e.jsx)(Ie.Z,{open:te,title:q,footer:null,onCancel:function(){return $(!1)},children:(0,e.jsx)("img",{alt:"example",style:{width:"100%"},src:ae})})]})},we=Pe,Ue=a(24969),Me=function(){var p,c=(0,m.useRef)(),U=(0,m.useState)(!1),M=f()(U,2),G=M[0],l=M[1],V=(0,m.useState)(),Y=f()(V,2),o=Y[0],j=Y[1],ee=(0,m.useState)(!1),H=f()(ee,2),k=H[0],Z=H[1],O=B.ZP.useMessage(),J=f()(O,2),K=J[0],te=J[1],$=(0,m.useState)({current:1,pageSize:20,pages:0,total:0}),W=f()($,2),I=W[0],ae=W[1],X=(0,m.useState)("CREATE"),Q=f()(X,2),b=Q[0],q=Q[1],D=(0,C.useRequest)(w.T,{manual:!0,onSuccess:function(){var s,t;K.success("Deleted successfully"),(s=c.current)===null||s===void 0||(t=s.reload)===null||t===void 0||t.call(s)},onError:function(s){console.log(">>> check e: ",s)}}),T=D.run,_=D.loading,ue=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"Name",dataIndex:"name",render:function(s,t,E,R,S){return(0,e.jsx)(C.Link,{to:"/crud/detail-restaurant/".concat(t._id),children:t.name})}},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Status",dataIndex:"isActive",hideInSearch:!0,valueEnum:{true:{text:(0,e.jsx)(z.Z,{color:"lime",children:"ACTIVE"}),status:"Success"},false:{text:(0,e.jsx)(z.Z,{color:"red",children:"INACTIVE"}),status:"Error"}}},{title:"Action",dataIndex:"",key:"x",hideInSearch:!0,render:function(s,t){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ae.Z,{onClick:function(){l(!0),j(t)},style:{cursor:"pointer"}}),"\xA0 \xA0 \xA0",(0,e.jsx)(je.Z,{style:{cursor:"pointer"},onClick:function(){q("UPDATE"),Z(!0),j(t)}}),"\xA0 \xA0 \xA0",(0,e.jsx)(fe.Z,{onConfirm:function(){T(t._id)},title:"Delete the restaurant",description:"Are you sure to delete this restaurant?",okText:"Yes",cancelText:"No",okButtonProps:{loading:_},children:(0,e.jsx)(Ee.Z,{style:{cursor:"pointer"}})})]})}}],le=[{title:"Name",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Status",dataIndex:"isActive",hideInSearch:!0,valueEnum:{true:{text:(0,e.jsx)(z.Z,{color:"lime",children:"ACTIVE"}),status:"Success"},false:{text:(0,e.jsx)(z.Z,{color:"red",children:"INACTIVE"}),status:"Error"}}},{title:"Rating",dataIndex:"rate"},{title:"Address",dataIndex:"address"},{title:"createdAt",dataIndex:"createdAt",valueType:"dateTime"},{title:"updatedAt",dataIndex:"updatedAt",valueType:"dateTime"},{title:"Image",dataIndex:"image",valueType:function(s,t){return s!=null&&s.image?{type:"image",width:200}:"text"},renderText:function(s,t,E,R){return t!=null&&t.image?"".concat("http://localhost:8080","/images/restaurant/").concat(t.image):"-"}}];return(0,e.jsx)(ge.ZP,{locale:Se.Z,children:(0,e.jsxs)(ve._z,{children:[te,(0,e.jsx)(me.Z,{headerTitle:"Restaurants Data",actionRef:c,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsx)(pe.ZP,{onClick:function(){q("CREATE"),Z(!0)},type:"primary",icon:(0,e.jsx)(Ue.Z,{}),children:"Add New"})]},request:P()(g()().mark(function d(){var s,t,E,R,S,x,A=arguments;return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=A.length>0&&A[0]!==void 0?A[0]:{},E=A.length>1?A[1]:void 0,R=A.length>2?A[2]:void 0,S="",t&&(S+="current=".concat(t.current,"&pageSize=").concat(t.pageSize),t.email&&(S+="&email=/".concat(t.email,"/i")),t.name&&(S+="&name=/".concat(t.name,"/i")),t.phone&&(S+="&phone=/".concat(t.phone,"/i"))),u.next=7,(0,C.request)("/api/v1/restaurants?".concat(S),{method:"GET"});case 7:return x=u.sent,x&&x.data&&ae(x.data.meta),u.abrupt("return",{data:x.data.results,success:!0,total:x==null||(s=x.data)===null||s===void 0||(s=s.meta)===null||s===void 0?void 0:s.total});case 10:case"end":return u.stop()}},d)})),pagination:{current:I.current,pageSize:I.pageSize,showSizeChanger:!0,total:I.total,showTotal:function(s,t){return(0,e.jsxs)("div",{children:[" ",t[0],"-",t[1]," tr\xEAn ",s," rows"]})}},columns:ue}),(0,e.jsx)(xe.Z,{width:800,open:G,onClose:function(){j(void 0),l(!1)},title:"Xem chi ti\u1EBFt restaurant",children:(o==null?void 0:o.name)&&(0,e.jsx)(he.vY,{bordered:!0,column:2,title:o==null?void 0:o.name,request:P()(g()().mark(function d(){return g()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{data:o||{}});case 1:case"end":return t.stop()}},d)})),params:{id:o==null?void 0:o.name},columns:le})}),(0,e.jsx)(we,{reload:(p=c.current)===null||p===void 0?void 0:p.reload,type:b,setOpen:Z,open:k,currentRow:o,setCurrentRow:j})]})})},Oe=Me}}]);
