"use strict";(self.webpackChunkhoidanit_admin_antd=self.webpackChunkhoidanit_admin_antd||[]).push([[664],{20443:function(Je,oe,a){a.r(oe),a.d(oe,{default:function(){return Ke}});var ve=a(15009),x=a.n(ve),me=a(99289),O=a.n(me),pe=a(5574),Z=a.n(pe),he=a(26466),fe=a(41756),ge=a(29945),L=a(2453),W=a(66309),xe=a(86738),Se=a(28459),Pe=a(85265),v=a(67294),je=a(97857),w=a.n(je),Y=a(2618),Ze=a(24969),le=a(37476),$=a(5966),b=a(32188),Ce=a(14726),ue=a(71230),I=a(15746),e=a(85893),Ee=function(n){var d=n.reload,C=L.ZP.useMessage(),m=Z()(C,2),u=m[0],S=m[1],P=(0,b.useRequest)(Y.r4,{manual:!0,onSuccess:function(){u.success("Added successfully"),d==null||d()},onError:function(c){console.log(">>> check e: ",c)}}),E=P.run,i=P.loading;return(0,e.jsxs)(e.Fragment,{children:[S,(0,e.jsx)(le.Y,{title:"Add new User",trigger:(0,e.jsx)(Ce.ZP,{type:"primary",icon:(0,e.jsx)(Ze.Z,{}),children:"Add New"}),modalProps:{okButtonProps:{loading:i},maskClosable:!1,destroyOnClose:!0},onFinish:function(){var f=O()(x()().mark(function c(y){return x()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,E(w()(w()({},y),{},{platform:"WEB"}));case 2:return F.abrupt("return",!0);case 3:case"end":return F.stop()}},c)}));return function(c){return f.apply(this,arguments)}}(),children:(0,e.jsxs)(ue.Z,{gutter:[30,0],children:[(0,e.jsx)(I.Z,{span:12,children:(0,e.jsx)($.Z,{label:"Email",rules:[{required:!0,message:"Email kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"},{type:"email",message:"Email kh\xF4ng \u0111\xFAng \u0111\u1ECBnh d\u1EA1ng"}],name:"email"})}),(0,e.jsx)(I.Z,{span:12,children:(0,e.jsx)($.Z.Password,{label:"Password",rules:[{required:!0,message:"Password kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"}],name:"password"})}),(0,e.jsx)(I.Z,{span:12,children:(0,e.jsx)($.Z,{label:"Name",name:"name",rules:[{required:!0,message:"Name kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"}]})})]})})]})},Ae=Ee,ye=a(18253),Fe=a(12119),Te=a(46117),Ie=a(31484),R=a(1413),_=a(91),ee=a(86543),Re=["fieldProps","min","proFieldProps","max"],we=function(n,d){var C=n.fieldProps,m=n.min,u=n.proFieldProps,S=n.max,P=(0,_.Z)(n,Re);return(0,e.jsx)(ee.Z,(0,R.Z)({valueType:"digit",fieldProps:(0,R.Z)({min:m,max:S},C),ref:d,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:u},P))},Ue=v.forwardRef(we),Me=Ue,ie=a(22270),de=a(66758),Ne=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],Oe=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],$e=function(n,d){var C=n.fieldProps,m=n.children,u=n.params,S=n.proFieldProps,P=n.mode,E=n.valueEnum,i=n.request,f=n.showSearch,c=n.options,y=(0,_.Z)(n,Ne),U=(0,v.useContext)(de.Z);return(0,e.jsx)(ee.Z,(0,R.Z)((0,R.Z)({valueEnum:(0,ie.h)(E),request:i,params:u,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,R.Z)({options:c,mode:P,showSearch:f,getPopupContainer:U.getPopupContainer},C),ref:d,proFieldProps:S},y),{},{children:m}))},De=v.forwardRef(function(h,n){var d=h.fieldProps,C=h.children,m=h.params,u=h.proFieldProps,S=h.mode,P=h.valueEnum,E=h.request,i=h.options,f=(0,_.Z)(h,Oe),c=(0,R.Z)({options:i,mode:S||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},d),y=(0,v.useContext)(de.Z);return(0,e.jsx)(ee.Z,(0,R.Z)((0,R.Z)({valueEnum:(0,ie.h)(P),request:E,params:m,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,R.Z)({getPopupContainer:y.getPopupContainer},c),ref:n,proFieldProps:u},f),{},{children:C}))}),Le=v.forwardRef($e),Be=De,ae=Le;ae.SearchSelect=Be,ae.displayName="ProFormComponent";var ze=ae,Ge=a(52688),Ve=a(53271),We=a(17788),ce=a(57632),Ye=function(n){var d=n.open,C=n.setOpen,m=n.reload,u=n.currentRow,S=n.setCurrentRow,P=L.ZP.useMessage(),E=Z()(P,2),i=E[0],f=E[1],c=(0,v.useRef)(),y=(0,v.useState)([]),U=Z()(y,2),F=U[0],H=U[1],K=(0,v.useState)(!1),J=Z()(K,2),te=J[0],B=J[1],X=(0,v.useState)(""),D=Z()(X,2),re=D[0],z=D[1],ne=(0,v.useState)(""),Q=Z()(ne,2),se=Q[0],k=Q[1];(0,v.useEffect)(function(){if(u&&d){var l,o;c==null||(l=c.current)===null||l===void 0||l.setFieldsValue(w()(w()({},u),{},{fileList:[{uid:(0,ce.Z)(),name:(o=u==null?void 0:u.avatar)!==null&&o!==void 0?o:"",status:"done",url:"".concat("http://localhost:8080","/images/avatar/").concat(u==null?void 0:u.avatar)}]})),H([{name:u.avatar,uid:(0,ce.Z)()}])}},[u,d]);var g=(0,b.useRequest)(Y.Nq,{manual:!0,onSuccess:function(){i.success("Update is successful"),m==null||m(),j()},onError:function(o){console.log(">>> check e: ",o)}}),s=g.run,r=function(o){var t=o.type==="image/jpeg"||o.type==="image/png"||o.type==="image/webp";t||L.ZP.error("You can only upload JPG/PNG/webp file!");var p=o.size/1024/1024<2;return p||L.ZP.error("Image must smaller than 2MB!"),t&&p},M=function(){var l=O()(x()().mark(function o(t){var p,A,G,T;return x()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return p=t.file,A=t.onSuccess,G=t.onError,V.next=3,(0,Y.cT)(p,"avatar");case 3:T=V.sent,T&&T.data?(H([{name:T.data.fileName,uid:p.uid}]),A("ok")):G("\u0110\xE3 c\xF3 l\u1ED7i khi upload file");case 5:case"end":return V.stop()}},o)}));return function(t){return l.apply(this,arguments)}}(),q=function(o,t){var p=new FileReader;p.addEventListener("load",function(){return t(p.result)}),p.readAsDataURL(o)},N=function(){var l=O()(x()().mark(function o(t){return x()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!(t.url&&!t.originFileObj)){A.next=5;break}return z(t.url),B(!0),k(t.name||t.url.substring(t.url.lastIndexOf("/")+1)),A.abrupt("return");case 5:q(t.originFileObj,function(G){z(G),B(!0),k(t.name||t.url.substring(t.url.lastIndexOf("/")+1))});case 6:case"end":return A.stop()}},o)}));return function(t){return l.apply(this,arguments)}}(),j=function(){var o;c==null||(o=c.current)===null||o===void 0||o.resetFields(),C(!1),S(void 0)};return(0,e.jsxs)(e.Fragment,{children:[f,(0,e.jsx)(le.Y,{formRef:c,title:"Update User",modalProps:{okButtonProps:{loading:!1},maskClosable:!1,destroyOnClose:!1,onClose:j,onCancel:j},onFinish:function(){var l=O()(x()().mark(function o(t){var p,A;return x()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return t!=null&&t.fileList&&delete t.fileList,A=w()(w()({},t),{},{avatar:(p=F[0])===null||p===void 0?void 0:p.name}),T.next=4,s(w()({},A));case 4:return T.abrupt("return",!0);case 5:case"end":return T.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),open:d,children:(0,e.jsxs)(ue.Z,{gutter:[30,0],children:[(0,e.jsx)($.Z,{name:"_id",hidden:!0}),(0,e.jsx)(I.Z,{span:12,children:(0,e.jsx)($.Z,{label:"Name",name:"name"})}),(0,e.jsx)(I.Z,{span:6,children:(0,e.jsx)($.Z,{label:"Phone",name:"phone"})}),(0,e.jsx)(I.Z,{span:6,children:(0,e.jsx)(Me,{label:"Age",name:"age",max:100,min:1})}),(0,e.jsx)(I.Z,{span:6,children:(0,e.jsx)(ze,{options:[{value:"MALE",label:"MALE"},{value:"FEMALE",label:"FEMALE"},{value:"UNKNOWN",label:"UNKNOWN"}],label:"Gender",name:"gender"})}),(0,e.jsx)(I.Z,{span:6,children:(0,e.jsx)(Ge.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",name:"isActive",label:"Status"})}),(0,e.jsx)(I.Z,{span:12,children:(0,e.jsx)(Ve.Z,{extra:"H\u1ED7 tr\u1EE3: .jpg, .jpeg, .png, .webp",label:"Avatar",name:"fileList",title:"upload",fieldProps:{maxCount:1,multiple:!1,customRequest:M,beforeUpload:r,onPreview:N}})})]})}),(0,e.jsx)(We.Z,{open:te,title:se,footer:null,onCancel:function(){return B(!1)},children:(0,e.jsx)("img",{alt:"example",style:{width:"100%"},src:re})})]})},be=Ye,He=function(){var n,d=(0,v.useRef)(),C=(0,v.useState)(!1),m=Z()(C,2),u=m[0],S=m[1],P=(0,v.useState)(),E=Z()(P,2),i=E[0],f=E[1],c=(0,v.useState)(!1),y=Z()(c,2),U=y[0],F=y[1],H=L.ZP.useMessage(),K=Z()(H,2),J=K[0],te=K[1],B=(0,v.useState)({current:1,pageSize:20,pages:0,total:0}),X=Z()(B,2),D=X[0],re=X[1],z=(0,b.useRequest)(Y.h8,{manual:!0,onSuccess:function(){var s,r;J.success("Deleted successfully"),(s=d.current)===null||s===void 0||(r=s.reload)===null||r===void 0||r.call(s)},onError:function(s){console.log(">>> check e: ",s)}}),ne=z.run,Q=z.loading,se=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"Name",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"Code",dataIndex:"codeId",hideInSearch:!0},{title:"Status",dataIndex:"isActive",hideInSearch:!0,valueEnum:{true:{text:(0,e.jsx)(W.Z,{color:"lime",children:"ACTIVE"}),status:"Success"},false:{text:(0,e.jsx)(W.Z,{color:"red",children:"INACTIVE"}),status:"Error"}}},{title:"codeExpired",dataIndex:"codeExpired",valueType:"dateTime",hideInSearch:!0},{title:"Action",dataIndex:"",key:"x",hideInSearch:!0,render:function(s,r){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Fe.Z,{onClick:function(){S(!0),f(r)},style:{cursor:"pointer"}}),"\xA0 \xA0 \xA0",(0,e.jsx)(Te.Z,{style:{cursor:"pointer"},onClick:function(){F(!0),f(r)}}),"\xA0 \xA0 \xA0",(0,e.jsx)(xe.Z,{onConfirm:function(){ne(r._id)},title:"Delete the user",description:"Are you sure to delete this user?",okText:"Yes",cancelText:"No",okButtonProps:{loading:Q},children:(0,e.jsx)(Ie.Z,{style:{cursor:"pointer"}})})]})}}],k=[{title:"Name",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Gender",dataIndex:"gender"},{title:"Role",dataIndex:"role"},{title:"Status",dataIndex:"isActive",hideInSearch:!0,valueEnum:{true:{text:(0,e.jsx)(W.Z,{color:"lime",children:"ACTIVE"}),status:"Success"},false:{text:(0,e.jsx)(W.Z,{color:"red",children:"INACTIVE"}),status:"Error"}}},{title:"createdAt",dataIndex:"createdAt",valueType:"dateTime"},{title:"updatedAt",dataIndex:"updatedAt",valueType:"dateTime"},{title:"Avatar",dataIndex:"avatar",valueType:function(s,r){return s!=null&&s.avatar?{type:"image",width:200}:"text"},renderText:function(s,r,M,q){return r!=null&&r.avatar?"".concat("http://localhost:8080","/images/avatar/").concat(r.avatar):"-"}}];return(0,e.jsx)(Se.ZP,{locale:ye.Z,children:(0,e.jsxs)(he._z,{children:[te,(0,e.jsx)(fe.Z,{headerTitle:"Users Data",actionRef:d,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){var s;return[(0,e.jsx)(Ae,{reload:(s=d.current)===null||s===void 0?void 0:s.reload},"create")]},request:O()(x()().mark(function g(){var s,r,M,q,N,j,l=arguments;return x()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.length>0&&l[0]!==void 0?l[0]:{},M=l.length>1?l[1]:void 0,q=l.length>2?l[2]:void 0,N="",r&&(N+="current=".concat(r.current,"&pageSize=").concat(r.pageSize),r.email&&(N+="&email=/".concat(r.email,"/i")),r.name&&(N+="&name=/".concat(r.name,"/i"))),t.next=7,(0,b.request)("/api/v1/users?".concat(N),{method:"GET"});case 7:return j=t.sent,j&&j.data&&re(j.data.meta),t.abrupt("return",{data:j.data.results,success:!0,total:j==null||(s=j.data)===null||s===void 0||(s=s.meta)===null||s===void 0?void 0:s.total});case 10:case"end":return t.stop()}},g)})),pagination:{current:D.current,pageSize:D.pageSize,showSizeChanger:!0,total:D.total,showTotal:function(s,r){return(0,e.jsxs)("div",{children:[" ",r[0],"-",r[1]," tr\xEAn ",s," rows"]})}},columns:se}),(0,e.jsx)(Pe.Z,{width:800,open:u,onClose:function(){f(void 0),S(!1)},title:"Xem chi ti\u1EBFt user",children:(i==null?void 0:i.name)&&(0,e.jsx)(ge.vY,{bordered:!0,column:2,title:i==null?void 0:i.name,request:O()(x()().mark(function g(){return x()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",{data:i||{}});case 1:case"end":return r.stop()}},g)})),params:{id:i==null?void 0:i.name},columns:k})}),(0,e.jsx)(be,{open:U,setOpen:F,currentRow:i,setCurrentRow:f,reload:(n=d.current)===null||n===void 0?void 0:n.reload})]})})},Ke=He}}]);
